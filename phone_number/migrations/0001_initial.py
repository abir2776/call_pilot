# Generated by Django 5.2.7 on 2026-02-05 10:31

import dirtyfields.dirtyfields
import django.db.models.deletion
import phonenumber_field.modelfields
import uuid
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('organizations', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='EndUser',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uid', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('end_user_sid', models.CharField(db_index=True, help_text='Twilio End User SID (starts with IT)', max_length=34, unique=True)),
                ('friendly_name', models.CharField(help_text='Friendly name for the end user', max_length=255)),
                ('end_user_type', models.CharField(choices=[('individual', 'Individual'), ('business', 'Business')], max_length=20)),
                ('business_name', models.CharField(blank=True, help_text='Legal business name', max_length=255)),
                ('business_registration_number', models.CharField(blank=True, help_text='Business registration/tax ID number', max_length=100)),
                ('business_registration_identifier', models.CharField(blank=True, help_text='Registration authority (e.g., EIN, VAT, ABN)', max_length=100)),
                ('business_website', models.URLField(blank=True, help_text='Business website URL')),
                ('business_identity', models.CharField(blank=True, help_text='Business classification/industry', max_length=50)),
                ('first_name', models.CharField(help_text='First name of authorized representative', max_length=100)),
                ('last_name', models.CharField(help_text='Last name of authorized representative', max_length=100)),
                ('email', models.EmailField(help_text='Email of authorized representative', max_length=254)),
                ('phone_number', phonenumber_field.modelfields.PhoneNumberField(help_text='Phone number of authorized representative', max_length=128, region=None)),
                ('is_subassigned', models.BooleanField(default=False, help_text='Whether number is assigned to end customer')),
                ('comments', models.TextField(blank=True, help_text='Optional comments')),
                ('status', models.CharField(default='active', max_length=20)),
                ('twilio_metadata', models.JSONField(blank=True, default=dict)),
                ('organization', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='end_users', to='organizations.organization')),
            ],
            options={
                'verbose_name': 'End User',
                'verbose_name_plural': 'End Users',
                'db_table': 'end_users',
                'ordering': ['-created_at'],
            },
            bases=(dirtyfields.dirtyfields.DirtyFieldsMixin, models.Model),
        ),
        migrations.CreateModel(
            name='RegulatoryBundle',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uid', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('bundle_sid', models.CharField(db_index=True, help_text='Twilio Bundle SID (starts with BU)', max_length=34, unique=True)),
                ('friendly_name', models.CharField(help_text='Friendly name for the bundle', max_length=255)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('PENDING_REVIEW', 'Pending Review'), ('IN_REVIEW', 'In Review'), ('TWILIO_APPROVED', 'Twilio Approved'), ('TWILIO_REJECTED', 'Twilio Rejected')], default='DRAFT', max_length=30)),
                ('iso_country', models.CharField(help_text='2-digit ISO country code (e.g., US, DE, AU)', max_length=2)),
                ('number_type', models.CharField(help_text='Phone number type: local, mobile, national, toll-free', max_length=20)),
                ('end_user_type', models.CharField(help_text='End user type: individual or business', max_length=20)),
                ('regulation_sid', models.CharField(blank=True, help_text='Twilio Regulation SID (starts with RN)', max_length=34)),
                ('email', models.EmailField(help_text='Email to receive bundle status updates', max_length=254)),
                ('status_callback_url', models.URLField(blank=True, help_text='Webhook URL for status updates')),
                ('rejection_reason', models.TextField(blank=True, help_text='Reason for rejection if bundle is rejected')),
                ('twilio_metadata', models.JSONField(blank=True, default=dict, help_text='Additional metadata from Twilio')),
                ('end_user', models.ForeignKey(blank=True, help_text='Associated end user information', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='bundles', to='phone_number.enduser')),
                ('organization', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='regulatory_bundles', to='organizations.organization')),
            ],
            options={
                'verbose_name': 'Regulatory Bundle',
                'verbose_name_plural': 'Regulatory Bundles',
                'db_table': 'regulatory_bundles',
                'ordering': ['-created_at'],
            },
            bases=(dirtyfields.dirtyfields.DirtyFieldsMixin, models.Model),
        ),
        migrations.CreateModel(
            name='SupportingDocument',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uid', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('document_sid', models.CharField(help_text='Twilio Supporting Document SID (starts with RD)', max_length=34, unique=True)),
                ('document_type', models.CharField(help_text='Type of document (e.g., passport, business_license)', max_length=50)),
                ('friendly_name', models.CharField(max_length=255)),
                ('file', models.FileField(blank=True, help_text='Uploaded document file', upload_to='regulatory_documents/%Y/%m/')),
                ('mime_type', models.CharField(blank=True, max_length=100)),
                ('status', models.CharField(default='pending', max_length=20)),
                ('twilio_metadata', models.JSONField(blank=True, default=dict)),
                ('bundle', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='documents', to='phone_number.regulatorybundle')),
                ('organization', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='supporting_documents', to='organizations.organization')),
            ],
            options={
                'verbose_name': 'Supporting Document',
                'verbose_name_plural': 'Supporting Documents',
                'db_table': 'supporting_documents',
                'ordering': ['-created_at'],
            },
            bases=(dirtyfields.dirtyfields.DirtyFieldsMixin, models.Model),
        ),
        migrations.CreateModel(
            name='TwilioSubAccount',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uid', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('twilio_account_sid', models.CharField(db_index=True, help_text='Twilio Subaccount SID (starts with AC)', max_length=34, unique=True)),
                ('twilio_auth_token', models.CharField(help_text='Twilio Auth Token for this subaccount', max_length=255)),
                ('friendly_name', models.CharField(help_text='Friendly name for the subaccount', max_length=255)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('PLACEHOLDER', 'Placeholder'), ('ACTIVE', 'Active'), ('HIDDEN', 'Hidden'), ('PAUSED', 'Paused'), ('REMOVED', 'Removed')], default='ACTIVE', max_length=20)),
                ('organization', models.OneToOneField(help_text='Customer who owns this subaccount', on_delete=django.db.models.deletion.CASCADE, related_name='twilio_subaccount', to='organizations.organization')),
            ],
            options={
                'verbose_name': 'Twilio Subaccount',
                'verbose_name_plural': 'Twilio Subaccounts',
                'db_table': 'twilio_subaccounts',
                'ordering': ['-created_at'],
            },
            bases=(dirtyfields.dirtyfields.DirtyFieldsMixin, models.Model),
        ),
        migrations.AddField(
            model_name='regulatorybundle',
            name='subaccount',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bundles', to='phone_number.twiliosubaccount'),
        ),
        migrations.CreateModel(
            name='RegulatoryAddress',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uid', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('address_sid', models.CharField(db_index=True, help_text='Twilio Address SID (starts with AD)', max_length=34, unique=True)),
                ('friendly_name', models.CharField(help_text='Friendly name for the address', max_length=255)),
                ('customer_name', models.CharField(help_text='Name of the customer/business', max_length=255)),
                ('street', models.CharField(help_text='Street address', max_length=255)),
                ('street_secondary', models.CharField(blank=True, help_text='Secondary street address (e.g., Apt, Suite)', max_length=255)),
                ('city', models.CharField(help_text='City', max_length=100)),
                ('region', models.CharField(help_text='State/Province/Region', max_length=100)),
                ('postal_code', models.CharField(help_text='Postal/ZIP code', max_length=20)),
                ('iso_country', models.CharField(help_text='2-digit ISO country code', max_length=2)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('VERIFIED', 'Verified'), ('FAILED', 'Failed')], default='PENDING', max_length=20)),
                ('emergency_enabled', models.BooleanField(default=False, help_text='Whether this address is enabled for emergency services')),
                ('twilio_metadata', models.JSONField(blank=True, default=dict)),
                ('organization', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='regulatory_addresses', to='organizations.organization')),
                ('subaccount', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='addresses', to='phone_number.twiliosubaccount')),
            ],
            options={
                'verbose_name': 'Regulatory Address',
                'verbose_name_plural': 'Regulatory Addresses',
                'db_table': 'regulatory_addresses',
                'ordering': ['-created_at'],
            },
            bases=(dirtyfields.dirtyfields.DirtyFieldsMixin, models.Model),
        ),
        migrations.AddField(
            model_name='enduser',
            name='subaccount',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='end_users', to='phone_number.twiliosubaccount'),
        ),
        migrations.CreateModel(
            name='TwilioPhoneNumber',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uid', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('twilio_sid', models.CharField(db_index=True, help_text='Twilio Phone Number SID (starts with PN)', max_length=34, unique=True)),
                ('phone_number', phonenumber_field.modelfields.PhoneNumberField(db_index=True, help_text='Phone number in E.164 format', max_length=128, region=None, unique=True)),
                ('friendly_name', models.CharField(blank=True, max_length=255)),
                ('country_code', models.CharField(max_length=2)),
                ('area_code', models.CharField(blank=True, max_length=10)),
                ('locality', models.CharField(blank=True, max_length=255)),
                ('region', models.CharField(blank=True, max_length=255)),
                ('number_type', models.CharField(help_text='local, mobile, national, toll-free', max_length=20)),
                ('voice_capable', models.BooleanField(default=True)),
                ('sms_capable', models.BooleanField(default=True)),
                ('mms_capable', models.BooleanField(default=False)),
                ('fax_capable', models.BooleanField(default=False)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('ACTIVE', 'Active'), ('RELEASED', 'Released'), ('SUSPENDED', 'Suspended')], default='PENDING', max_length=20)),
                ('compliance_status', models.CharField(default='pending', help_text='Compliance verification status', max_length=30)),
                ('voice_url', models.URLField(blank=True)),
                ('sms_url', models.URLField(blank=True)),
                ('monthly_cost', models.DecimalField(decimal_places=2, default=0.0, max_digits=10)),
                ('purchase_date', models.DateTimeField(auto_now_add=True)),
                ('release_date', models.DateTimeField(blank=True, null=True)),
                ('is_primary', models.BooleanField(default=False)),
                ('notes', models.TextField(blank=True)),
                ('twilio_metadata', models.JSONField(blank=True, default=dict)),
                ('address', models.ForeignKey(blank=True, help_text='Associated address', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='phone_numbers', to='phone_number.regulatoryaddress')),
                ('bundle', models.ForeignKey(blank=True, help_text='Associated regulatory bundle', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='phone_numbers', to='phone_number.regulatorybundle')),
                ('organization', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='twilio_phone_numbers', to='organizations.organization')),
                ('subaccount', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='phone_numbers', to='phone_number.twiliosubaccount')),
            ],
            options={
                'verbose_name': 'Twilio Phone Number',
                'verbose_name_plural': 'Twilio Phone Numbers',
                'db_table': 'twilio_phone_numbers',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['organization_id', 'status'], name='twilio_phon_organiz_b13383_idx'), models.Index(fields=['subaccount_id', 'status'], name='twilio_phon_subacco_63aa37_idx'), models.Index(fields=['phone_number'], name='twilio_phon_phone_n_d9d7b3_idx'), models.Index(fields=['twilio_sid'], name='twilio_phon_twilio__e521f8_idx')],
            },
            bases=(dirtyfields.dirtyfields.DirtyFieldsMixin, models.Model),
        ),
        migrations.AddIndex(
            model_name='regulatorybundle',
            index=models.Index(fields=['organization_id', 'status'], name='regulatory__organiz_1d3dfa_idx'),
        ),
        migrations.AddIndex(
            model_name='regulatorybundle',
            index=models.Index(fields=['bundle_sid'], name='regulatory__bundle__5eceb7_idx'),
        ),
        migrations.AddIndex(
            model_name='regulatoryaddress',
            index=models.Index(fields=['organization_id', 'status'], name='regulatory__organiz_80b52a_idx'),
        ),
        migrations.AddIndex(
            model_name='regulatoryaddress',
            index=models.Index(fields=['address_sid'], name='regulatory__address_3b6161_idx'),
        ),
    ]
